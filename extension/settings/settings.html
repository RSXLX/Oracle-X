<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oracle-X 设置</title>
  <link rel="stylesheet" href="settings.css">
</head>

<body>
  <div class="container">
    <header class="header">
      <div class="logo">
        <img src="../icons/logo.svg" alt="Oracle-X Logo" class="logo-icon" />
        <span class="logo-text">Oracle-X</span>
      </div>
      <span class="version-badge">设置</span>
    </header>

    <!-- Desktop 连接状态 -->
    <div id="desktopStatus" class="desktop-status checking">
      <span id="desktopStatusDot" class="status-dot"></span>
      <span id="desktopStatusText">正在检测 Oracle-X Desktop...</span>
    </div>

    <section class="card">
      <div class="card-header">
        <span class="card-icon">🔑</span> API及模型配置
      </div>
      <div class="field">
        <label for="backendUrl">后端服务地址 (可选)</label>
        <input type="text" id="backendUrl" placeholder="http://localhost:3000" />
        <span class="field-hint">Desktop 在线时自动使用本地服务，无需填写</span>
      </div>
      <div class="field">
        <label for="aiBaseUrl">大模型接口地址</label>
        <input type="text" id="aiBaseUrl" placeholder="https://api.stepfun.com/v1" />
        <span class="field-hint">OpenAI 兼容的网关地址</span>
      </div>
      <div class="field">
        <label for="aiApiKey">API 密钥 (API Key)</label>
        <input type="password" id="aiApiKey" placeholder="sk-..." />
      </div>
      <div class="field">
        <label for="aiModel">核心分析模型</label>
        <input type="text" id="aiModel" placeholder="step-1-8k" />
      </div>
      <div class="field">
        <label for="aiVisionModel">视觉识别模型</label>
        <input type="text" id="aiVisionModel" placeholder="step-1o-turbo-vision" />
      </div>
    </section>

    <!-- 风险控制 -->
    <section class="card">
      <div class="card-header">
        <span class="card-icon">🛡️</span> 风险控制
      </div>
      <div class="field">
        <label for="riskProfile">风险档位</label>
        <select id="riskProfile">
          <option value="conservative">保守型 – 低容忍度，严格拦截</option>
          <option value="balanced" selected>平衡型 – 适中拦截</option>
          <option value="aggressive">积极型 – 仅极端情况拦截</option>
        </select>
      </div>
      <div class="field">
        <label for="coolingTime">冷静期 (秒)</label>
        <input type="number" id="coolingTime" min="5" max="120" value="20" />
        <span class="field-hint">触发 WARN/BLOCK 后的冷静等待时间</span>
      </div>
      <div class="field checkbox-field">
        <input type="checkbox" id="enableNoFomoBlock" checked />
        <label for="enableNoFomoBlock">启用 NoFOMO 强制阻断</label>
      </div>
    </section>

    <!-- 智能拦截 -->
    <section class="card">
      <div class="card-header">
        <span class="card-icon">🎯</span> 智能拦截 (Smart Intercept)
      </div>
      <div class="field checkbox-field">
        <input type="checkbox" id="enableSmartIntercept" checked />
        <label for="enableSmartIntercept">启用智能拦截分析</label>
      </div>
      <div class="field">
        <label for="interceptSensitivity">分析灵敏度</label>
        <select id="interceptSensitivity">
          <option value="conservative">保守 – 仅高风险时拦截分析</option>
          <option value="balanced" selected>标准 – 中/高风险时拦截分析</option>
          <option value="aggressive">激进 – 所有操作都分析</option>
        </select>
      </div>
      <div class="field">
        <label for="lowRiskNotify">低风险通知方式</label>
        <select id="lowRiskNotify">
          <option value="bubble" selected>气泡通知（1秒自动消失）</option>
          <option value="silent">静默放行</option>
          <option value="off">关闭通知</option>
        </select>
      </div>
      <div class="field">
        <label for="cacheExpiry">分析缓存时间 (秒)</label>
        <input type="number" id="cacheExpiry" min="60" max="600" value="300" />
        <span class="field-hint">同品种重复操作时复用缓存结果</span>
      </div>
      <div class="field">
        <label for="apiTimeout">API 超时 (秒)</label>
        <input type="number" id="apiTimeout" min="3" max="15" value="5" />
        <span class="field-hint">超时后自动放行，不阻断交易</span>
      </div>
    </section>

    <!-- 平台监控 -->
    <section class="card">
      <div class="card-header">
        <span class="card-icon">👁️</span> 平台监控
      </div>
      <div class="platforms-grid" id="platformsGrid">
        <!-- JS 动态生成 -->
      </div>
    </section>

    <!-- 操作栏 -->
    <div class="actions">
      <button id="saveBtn" class="btn btn-primary">💾 保存设置</button>
      <button id="resetBtn" class="btn btn-secondary">↺ 重置默认</button>
    </div>

    <div id="toast" class="toast hidden"></div>
  </div>

  <script src="settings.js"></script>
</body>

</html>